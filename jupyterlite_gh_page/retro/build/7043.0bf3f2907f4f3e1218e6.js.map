{"version":3,"sources":["webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/@retrolab/notebook-extension/lib/index.js"],"names":["KERNEL_STATUS_ERROR_CLASS","KERNEL_STATUS_WARN_CLASS","KERNEL_STATUS_INFO_CLASS","KERNEL_STATUS_FADE_OUT_CLASS","checkpoints","id","autoStart","requires","IDocumentManager","optional","IRetroShell","activate","app","docManager","retroShell","shell","widget","Widget","DOMUtils","addClass","add","rank","onChange","async","current","currentWidget","context","contextForWidget","fileChanged","disconnect","connect","listCheckpoints","checkpoint","length","node","textContent","Time","Date","last_modified","currentChanged","Poll","auto","factory","frequency","interval","backoff","standby","kernelLogo","serviceManager","baseUrl","PageConfig","_a","_b","_c","_d","_e","dispose","parent","NotebookPanel","sessionContext","ready","kernelChanged","name","session","kernel","spec","kernelspecs","specs","kernelIconUrl","resources","index","indexOf","slice","document","createElement","img","src","title","display_name","appendChild","kernelStatus","onStatusChanged","status","kernelDisplayStatus","text","Text","removeClass","statusChanged","paths","RetroApp","Error","provides","JupyterFrontEnd","RetroShell"],"mappings":"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","file":"7043.0bf3f2907f4f3e1218e6.js","sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { JupyterFrontEnd } from '@jupyterlab/application';\nimport { DOMUtils } from '@jupyterlab/apputils';\nimport { PageConfig, Text, Time } from '@jupyterlab/coreutils';\nimport { IDocumentManager } from '@jupyterlab/docmanager';\nimport { NotebookPanel } from '@jupyterlab/notebook';\nimport { RetroApp, RetroShell, IRetroShell } from '@retrolab/application';\nimport { Poll } from '@lumino/polling';\nimport { Widget } from '@lumino/widgets';\n/**\n * The class for kernel status errors.\n */\nconst KERNEL_STATUS_ERROR_CLASS = 'jp-RetroKernelStatus-error';\n/**\n * The class for kernel status warnings.\n */\nconst KERNEL_STATUS_WARN_CLASS = 'jp-RetroKernelStatus-warn';\n/**\n * The class for kernel status infos.\n */\nconst KERNEL_STATUS_INFO_CLASS = 'jp-RetroKernelStatus-info';\n/**\n * The class to fade out the kernel status.\n */\nconst KERNEL_STATUS_FADE_OUT_CLASS = 'jp-RetroKernelStatus-fade';\n/**\n * A plugin for the checkpoint indicator\n */\nconst checkpoints = {\n    id: '@retrolab/application-extension:checkpoints',\n    autoStart: true,\n    requires: [IDocumentManager],\n    optional: [IRetroShell],\n    activate: (app, docManager, retroShell) => {\n        const { shell } = app;\n        const widget = new Widget();\n        widget.id = DOMUtils.createDomID();\n        widget.addClass('jp-RetroCheckpoint');\n        app.shell.add(widget, 'top', { rank: 100 });\n        const onChange = async () => {\n            const current = shell.currentWidget;\n            if (!current) {\n                return;\n            }\n            const context = docManager.contextForWidget(current);\n            context === null || context === void 0 ? void 0 : context.fileChanged.disconnect(onChange);\n            context === null || context === void 0 ? void 0 : context.fileChanged.connect(onChange);\n            const checkpoints = await (context === null || context === void 0 ? void 0 : context.listCheckpoints());\n            if (!checkpoints) {\n                return;\n            }\n            const checkpoint = checkpoints[checkpoints.length - 1];\n            widget.node.textContent = `Last Checkpoint: ${Time.formatHuman(new Date(checkpoint.last_modified))}`;\n        };\n        if (retroShell) {\n            retroShell.currentChanged.connect(onChange);\n        }\n        new Poll({\n            auto: true,\n            factory: () => onChange(),\n            frequency: {\n                interval: 2000,\n                backoff: false\n            },\n            standby: 'when-hidden'\n        });\n    }\n};\n/**\n * The kernel logo plugin.\n */\nconst kernelLogo = {\n    id: '@retrolab/application-extension:kernel-logo',\n    autoStart: true,\n    requires: [IRetroShell],\n    activate: (app, shell) => {\n        const { serviceManager } = app;\n        const baseUrl = PageConfig.getBaseUrl();\n        let widget;\n        const onChange = async () => {\n            var _a, _b, _c, _d, _e;\n            if (widget) {\n                widget.dispose();\n                widget.parent = null;\n            }\n            const current = shell.currentWidget;\n            if (!(current instanceof NotebookPanel)) {\n                return;\n            }\n            await current.sessionContext.ready;\n            current.sessionContext.kernelChanged.disconnect(onChange);\n            current.sessionContext.kernelChanged.connect(onChange);\n            const name = (_c = (_b = (_a = current.sessionContext.session) === null || _a === void 0 ? void 0 : _a.kernel) === null || _b === void 0 ? void 0 : _b.name) !== null && _c !== void 0 ? _c : '';\n            const spec = (_e = (_d = serviceManager.kernelspecs) === null || _d === void 0 ? void 0 : _d.specs) === null || _e === void 0 ? void 0 : _e.kernelspecs[name];\n            if (!spec) {\n                return;\n            }\n            let kernelIconUrl = spec.resources['logo-64x64'];\n            if (!kernelIconUrl) {\n                return;\n            }\n            const index = kernelIconUrl.indexOf('kernelspecs');\n            kernelIconUrl = baseUrl + kernelIconUrl.slice(index);\n            const node = document.createElement('div');\n            const img = document.createElement('img');\n            img.src = kernelIconUrl;\n            img.title = spec.display_name;\n            node.appendChild(img);\n            widget = new Widget({ node });\n            widget.addClass('jp-RetroKernelLogo');\n            app.shell.add(widget, 'top', { rank: 10010 });\n        };\n        shell.currentChanged.connect(onChange);\n    }\n};\n/**\n * A plugin to display the kernel status;\n */\nconst kernelStatus = {\n    id: '@retrolab/application-extension:kernel-status',\n    autoStart: true,\n    requires: [IRetroShell],\n    activate: (app, shell) => {\n        const widget = new Widget();\n        widget.addClass('jp-RetroKernelStatus');\n        app.shell.add(widget, 'menu', { rank: 10010 });\n        const removeClasses = () => {\n            widget.removeClass(KERNEL_STATUS_ERROR_CLASS);\n            widget.removeClass(KERNEL_STATUS_WARN_CLASS);\n            widget.removeClass(KERNEL_STATUS_INFO_CLASS);\n            widget.removeClass(KERNEL_STATUS_FADE_OUT_CLASS);\n        };\n        const onStatusChanged = (sessionContext) => {\n            const status = sessionContext.kernelDisplayStatus;\n            let text = `Kernel ${Text.titleCase(status)}`;\n            removeClasses();\n            switch (status) {\n                case 'busy':\n                case 'idle':\n                    text = '';\n                    widget.addClass(KERNEL_STATUS_FADE_OUT_CLASS);\n                    break;\n                case 'dead':\n                case 'terminating':\n                    widget.addClass(KERNEL_STATUS_ERROR_CLASS);\n                    break;\n                case 'unknown':\n                    widget.addClass(KERNEL_STATUS_WARN_CLASS);\n                    break;\n                default:\n                    widget.addClass(KERNEL_STATUS_INFO_CLASS);\n                    widget.addClass(KERNEL_STATUS_FADE_OUT_CLASS);\n                    break;\n            }\n            widget.node.textContent = text;\n        };\n        const onChange = async () => {\n            const current = shell.currentWidget;\n            if (!(current instanceof NotebookPanel)) {\n                return;\n            }\n            const sessionContext = current.sessionContext;\n            sessionContext.statusChanged.connect(onStatusChanged);\n        };\n        shell.currentChanged.connect(onChange);\n    }\n};\n/**\n * The default paths for a RetroLab app.\n */\nconst paths = {\n    id: '@retrolab/application-extension:paths',\n    activate: (app) => {\n        if (!(app instanceof RetroApp)) {\n            throw new Error(`${paths.id} must be activated in RetroLab.`);\n        }\n        return app.paths;\n    },\n    autoStart: true,\n    provides: JupyterFrontEnd.IPaths\n};\n/**\n * The default RetroLab application shell.\n */\nconst shell = {\n    id: '@retrolab/application-extension:shell',\n    activate: (app) => {\n        if (!(app.shell instanceof RetroShell)) {\n            throw new Error(`${shell.id} did not find a RetroShell instance.`);\n        }\n        return app.shell;\n    },\n    autoStart: true,\n    provides: IRetroShell\n};\n/**\n * Export the plugins as default.\n */\nconst plugins = [\n    checkpoints,\n    kernelLogo,\n    kernelStatus\n];\nexport default plugins;\n"],"sourceRoot":""}