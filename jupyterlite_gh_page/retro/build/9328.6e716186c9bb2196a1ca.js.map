{"version":3,"sources":["webpack://_JUPYTERLAB.CORE_OUTPUT/../packages/kernel/lib/kernel.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../packages/kernel/lib/tokens.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../node_modules/worker-loader/dist/packages/xeus-kernel/lib/worker.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../packages/xeus-kernel/lib/kernel.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../packages/xeus-kernel-extension/lib/index.js"],"names":["BaseKernel","constructor","options","this","_history","_executionCount","_isDisposed","_disposed","Signal","_parentHeader","undefined","_parent","id","name","sendMessage","_id","_name","_sendMessage","Promise","resolve","dispose","isDisposed","emit","msg","_busy","header","msg_type","_kernelInfo","_execute","inputReply","content","_inspect","_isCompleteRequest","_complete","_historyRequest","commOpen","commMsg","commClose","_idle","stream","_a","_b","message","KernelMessage","channel","msgType","session","parentHeader","displayData","_c","metadata","inputRequest","publishExecuteResult","publishExecuteError","updateDisplayData","clearOutput","handleComm","type","buffers","parent","execution_state","kernelInfoRequest","historyMsg","status","history","_executeInput","code","execution_count","executeMsg","push","reply","executeRequest","completeMsg","completeRequest","inspectMsg","inspectRequest","isCompleteMsg","isCompleteRequest","IKernels","Token","IKernelSpecs","Worker_fn","Worker","XeusKernel","super","_executeDelegate","PromiseDelegate","_worker","onmessage","e","_processWorkerMessage","data","_d","_e","_f","_g","bundle","text","console","log","prompt","password","results","transient","wait","ename","evalue","traceback","implementation","implementation_version","language_info","codemirror_mode","version","file_extension","mimetype","nbconvert_exporter","pygments_lexer","protocol_version","banner","help_links","url","result","_sendRequestMessageToWorker","executionCount","postMessage","promise","autoStart","requires","activate","app","kernelspecs","register","spec","display_name","language","argv","env","interrupt_mode","resources","create","async"],"mappings":"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","file":"9328.6e716186c9bb2196a1ca.js","sourcesContent":["import { KernelMessage } from '@jupyterlab/services';\nimport { Signal } from '@lumino/signaling';\n/**\n * A base kernel class handling basic kernel messaging.\n */\nexport class BaseKernel {\n    /**\n     * Construct a new BaseKernel.\n     *\n     * @param options The instantiation options for a BaseKernel.\n     */\n    constructor(options) {\n        this._history = [];\n        this._executionCount = 0;\n        this._isDisposed = false;\n        this._disposed = new Signal(this);\n        this._parentHeader = undefined;\n        this._parent = undefined;\n        const { id, name, sendMessage } = options;\n        this._id = id;\n        this._name = name;\n        this._sendMessage = sendMessage;\n    }\n    /**\n     * A promise that is fulfilled when the kernel is ready.\n     */\n    get ready() {\n        return Promise.resolve();\n    }\n    /**\n     * Return whether the kernel is disposed.\n     */\n    get isDisposed() {\n        return this._isDisposed;\n    }\n    /**\n     * A signal emitted when the kernel is disposed.\n     */\n    get disposed() {\n        return this._disposed;\n    }\n    /**\n     * Get the kernel id\n     */\n    get id() {\n        return this._id;\n    }\n    /**\n     * Get the name of the kernel\n     */\n    get name() {\n        return this._name;\n    }\n    /**\n     * The current execution count\n     */\n    get executionCount() {\n        return this._executionCount;\n    }\n    /**\n     * Get the last parent header\n     */\n    get parentHeader() {\n        return this._parentHeader;\n    }\n    /**\n     * Get the last parent message (mimick ipykernel's get_parent)\n     */\n    get parent() {\n        return this._parent;\n    }\n    /**\n     * Dispose the kernel.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        this._isDisposed = true;\n        this._disposed.emit(void 0);\n    }\n    /**\n     * Handle an incoming message from the client.\n     *\n     * @param msg The message to handle\n     */\n    async handleMessage(msg) {\n        this._busy(msg);\n        this._parent = msg;\n        const msgType = msg.header.msg_type;\n        switch (msgType) {\n            case 'kernel_info_request':\n                await this._kernelInfo(msg);\n                break;\n            case 'execute_request':\n                await this._execute(msg);\n                break;\n            case 'input_reply':\n                this.inputReply(msg.content);\n                break;\n            case 'inspect_request':\n                await this._inspect(msg);\n                break;\n            case 'is_complete_request':\n                await this._isCompleteRequest(msg);\n                break;\n            case 'complete_request':\n                await this._complete(msg);\n                break;\n            case 'history_request':\n                await this._historyRequest(msg);\n                break;\n            case 'comm_open':\n                await this.commOpen(msg);\n                break;\n            case 'comm_msg':\n                await this.commMsg(msg);\n                break;\n            case 'comm_close':\n                await this.commClose(msg);\n                break;\n            default:\n                break;\n        }\n        this._idle(msg);\n    }\n    /**\n     * Stream an event from the kernel\n     *\n     * @param parentHeader The parent header.\n     * @param content The stream content.\n     */\n    stream(content) {\n        var _a, _b;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'stream',\n            // TODO: better handle this\n            session: (_b = (_a = this._parentHeader) === null || _a === void 0 ? void 0 : _a.session) !== null && _b !== void 0 ? _b : '',\n            parentHeader: this._parentHeader,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `display_data` message to the client.\n     *\n     * @param content The display_data content.\n     */\n    displayData(content) {\n        var _a, _b, _c;\n        // Make sure metadata is always set\n        content.metadata = (_a = content.metadata) !== null && _a !== void 0 ? _a : {};\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'display_data',\n            // TODO: better handle this\n            session: (_c = (_b = this._parentHeader) === null || _b === void 0 ? void 0 : _b.session) !== null && _c !== void 0 ? _c : '',\n            parentHeader: this._parentHeader,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `input_request` message to the client.\n     *\n     * @param content The input_request content.\n     */\n    inputRequest(content) {\n        var _a, _b;\n        const message = KernelMessage.createMessage({\n            channel: 'stdin',\n            msgType: 'input_request',\n            // TODO: better handle this\n            session: (_b = (_a = this._parentHeader) === null || _a === void 0 ? void 0 : _a.session) !== null && _b !== void 0 ? _b : '',\n            parentHeader: this._parentHeader,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send an `execute_result` message.\n     *\n     * @param content The execut result content.\n     */\n    publishExecuteResult(content) {\n        var _a, _b;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'execute_result',\n            // TODO: better handle this\n            session: (_b = (_a = this._parentHeader) === null || _a === void 0 ? void 0 : _a.session) !== null && _b !== void 0 ? _b : '',\n            parentHeader: this._parentHeader,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send an `error` message to the client.\n     *\n     * @param content The error content.\n     */\n    publishExecuteError(content) {\n        var _a, _b;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'error',\n            // TODO: better handle this\n            session: (_b = (_a = this._parentHeader) === null || _a === void 0 ? void 0 : _a.session) !== null && _b !== void 0 ? _b : '',\n            parentHeader: this._parentHeader,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `update_display_data` message to the client.\n     *\n     * @param content The update_display_data content.\n     */\n    updateDisplayData(content) {\n        var _a, _b;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'update_display_data',\n            // TODO: better handle this\n            session: (_b = (_a = this._parentHeader) === null || _a === void 0 ? void 0 : _a.session) !== null && _b !== void 0 ? _b : '',\n            parentHeader: this._parentHeader,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `clear_output` message to the client.\n     *\n     * @param content The clear_output content.\n     */\n    clearOutput(content) {\n        var _a, _b;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: 'clear_output',\n            // TODO: better handle this\n            session: (_b = (_a = this._parentHeader) === null || _a === void 0 ? void 0 : _a.session) !== null && _b !== void 0 ? _b : '',\n            parentHeader: this._parentHeader,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a `comm` message to the client.\n     *\n     * @param .\n     */\n    handleComm(type, content, metadata, buffers) {\n        var _a, _b;\n        const message = KernelMessage.createMessage({\n            channel: 'iopub',\n            msgType: type,\n            // TODO: better handle this\n            session: (_b = (_a = this._parentHeader) === null || _a === void 0 ? void 0 : _a.session) !== null && _b !== void 0 ? _b : '',\n            parentHeader: this._parentHeader,\n            content,\n            metadata,\n            buffers\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send an 'idle' status message.\n     *\n     * @param parent The parent message\n     */\n    _idle(parent) {\n        const message = KernelMessage.createMessage({\n            msgType: 'status',\n            session: parent.header.session,\n            parentHeader: parent.header,\n            channel: 'iopub',\n            content: {\n                execution_state: 'idle'\n            }\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send a 'busy' status message.\n     *\n     * @param parent The parent message.\n     */\n    _busy(parent) {\n        const message = KernelMessage.createMessage({\n            msgType: 'status',\n            session: parent.header.session,\n            parentHeader: parent.header,\n            channel: 'iopub',\n            content: {\n                execution_state: 'busy'\n            }\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle a kernel_info_request message\n     *\n     * @param parent The parent message.\n     */\n    async _kernelInfo(parent) {\n        const content = await this.kernelInfoRequest();\n        const message = KernelMessage.createMessage({\n            msgType: 'kernel_info_reply',\n            channel: 'shell',\n            session: parent.header.session,\n            parentHeader: parent.header,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle a `history_request` message\n     *\n     * @param msg The parent message.\n     */\n    async _historyRequest(msg) {\n        const historyMsg = msg;\n        const message = KernelMessage.createMessage({\n            msgType: 'history_reply',\n            channel: 'shell',\n            parentHeader: historyMsg.header,\n            session: msg.header.session,\n            content: {\n                status: 'ok',\n                history: this._history\n            }\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Send an `execute_input` message.\n     *\n     * @param msg The parent message.\n     */\n    _executeInput(msg) {\n        const parent = msg;\n        const code = parent.content.code;\n        const message = KernelMessage.createMessage({\n            msgType: 'execute_input',\n            parentHeader: parent.header,\n            channel: 'iopub',\n            session: msg.header.session,\n            content: {\n                code,\n                execution_count: this._executionCount\n            }\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle an execute_request message.\n     *\n     * @param msg The parent message.\n     */\n    async _execute(msg) {\n        const executeMsg = msg;\n        const content = executeMsg.content;\n        this._executionCount++;\n        // TODO: handle differently\n        this._parentHeader = executeMsg.header;\n        this._executeInput(executeMsg);\n        this._history.push([0, 0, content.code]);\n        const reply = await this.executeRequest(executeMsg.content);\n        const message = KernelMessage.createMessage({\n            msgType: 'execute_reply',\n            channel: 'shell',\n            parentHeader: executeMsg.header,\n            session: msg.header.session,\n            content: reply\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle an complete_request message\n     *\n     * @param msg The parent message.\n     */\n    async _complete(msg) {\n        const completeMsg = msg;\n        const content = await this.completeRequest(completeMsg.content);\n        const message = KernelMessage.createMessage({\n            msgType: 'complete_reply',\n            parentHeader: completeMsg.header,\n            channel: 'shell',\n            session: msg.header.session,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle an inspect_request message\n     *\n     * @param msg The parent message.\n     */\n    async _inspect(msg) {\n        const inspectMsg = msg;\n        const content = await this.inspectRequest(inspectMsg.content);\n        const message = KernelMessage.createMessage({\n            msgType: 'inspect_reply',\n            parentHeader: inspectMsg.header,\n            channel: 'shell',\n            session: msg.header.session,\n            content\n        });\n        this._sendMessage(message);\n    }\n    /**\n     * Handle an is_complete_request message\n     *\n     * @param msg The parent message.\n     */\n    async _isCompleteRequest(msg) {\n        const isCompleteMsg = msg;\n        const content = await this.isCompleteRequest(isCompleteMsg.content);\n        const message = KernelMessage.createMessage({\n            msgType: 'is_complete_reply',\n            parentHeader: isCompleteMsg.header,\n            channel: 'shell',\n            session: msg.header.session,\n            content\n        });\n        this._sendMessage(message);\n    }\n}\n","import { Token } from '@lumino/coreutils';\n/**\n * The token for the kernels service.\n */\nexport const IKernels = new Token('@jupyterlite/kernel:IKernels');\n/**\n * The token for the kernel spec service.\n */\nexport const IKernelSpecs = new Token('@jupyterlite/kernelspec:IKernelSpecs');\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"bundle.worker.js\");\n}\n","import { BaseKernel } from '@jupyterlite/kernel';\nimport { PromiseDelegate } from '@lumino/coreutils';\n// import createXeusModule from './xeus_dummy';\n// import {XeusInterpreter} from './xeus_interpreter';\nimport XeusWorker from \"worker-loader!./worker\";\nexport class XeusKernel extends BaseKernel {\n    constructor(options) {\n        super(options);\n        this._executeDelegate = new PromiseDelegate();\n        this._worker = new XeusWorker();\n        this._worker.onmessage = e => {\n            this._processWorkerMessage(e.data);\n        };\n    }\n    /**\n     * Dispose the kernel.\n     */\n    dispose() {\n        if (this.isDisposed) {\n            return;\n        }\n        super.dispose();\n    }\n    /**\n     * A promise that is fulfilled when the kernel is ready.\n     */\n    // get ready(): Promise<void> {\n    //   return this._ready.promise;\n    // }\n    /**\n      * Process a message coming from the pyodide web worker.\n      *\n      * @param msg The worker message to process.\n      */\n    _processWorkerMessage(msg) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        switch (msg.type) {\n            case 'stream': {\n                const bundle = (_a = msg.bundle) !== null && _a !== void 0 ? _a : { name: 'stdout', text: '' };\n                this.stream(bundle);\n                break;\n            }\n            case 'input_request': {\n                console.log(\"input-request\", msg.content);\n                const bundle = (_b = msg.content) !== null && _b !== void 0 ? _b : { prompt: '', password: false };\n                this.inputRequest(bundle);\n                break;\n            }\n            case 'reply': {\n                const bundle = msg.results;\n                this._executeDelegate.resolve(bundle);\n                break;\n            }\n            case 'display_data': {\n                const bundle = (_c = msg.bundle) !== null && _c !== void 0 ? _c : { data: {}, metadata: {}, transient: {} };\n                this.displayData(bundle);\n                break;\n            }\n            case 'update_display_data': {\n                const bundle = (_d = msg.bundle) !== null && _d !== void 0 ? _d : { data: {}, metadata: {}, transient: {} };\n                this.updateDisplayData(bundle);\n                break;\n            }\n            case 'clear_output': {\n                const bundle = (_e = msg.bundle) !== null && _e !== void 0 ? _e : { wait: false };\n                this.clearOutput(bundle);\n                break;\n            }\n            case 'execute_result': {\n                const bundle = (_f = msg.bundle) !== null && _f !== void 0 ? _f : { execution_count: 0, data: {}, metadata: {} };\n                this.publishExecuteResult(bundle);\n                break;\n            }\n            case 'execute_error': {\n                const bundle = (_g = msg.bundle) !== null && _g !== void 0 ? _g : { ename: '', evalue: '', traceback: [] };\n                this.publishExecuteError(bundle);\n                break;\n            }\n            case 'comm_msg':\n            case 'comm_open':\n            case 'comm_close': {\n                this.handleComm(msg.type, msg.content, msg.metadata, msg.buffers);\n                break;\n            }\n            default:\n                this._executeDelegate.resolve({\n                    data: {},\n                    metadata: {}\n                });\n                break;\n        }\n    }\n    /**\n     * Handle a kernel_info_request message\n     */\n    async kernelInfoRequest() {\n        const content = {\n            implementation: 'xeus',\n            implementation_version: '0.1.0',\n            language_info: {\n                codemirror_mode: {\n                    name: 'lua',\n                    version: 3\n                },\n                file_extension: '.lua',\n                mimetype: 'text/x-lua',\n                name: 'lua',\n                nbconvert_exporter: 'lua',\n                pygments_lexer: 'lua',\n                version: '5.3'\n            },\n            protocol_version: '5.3',\n            status: 'ok',\n            banner: 'Xeus: A WebAssembly-powered dummy kernel backed by xeus',\n            help_links: [\n                {\n                    text: 'Lua (WASM) Kernel',\n                    url: 'https://xeus.org'\n                }\n            ]\n        };\n        return content;\n    }\n    /**\n     * Handle an `execute_request` message\n     *\n     * @param msg The parent message.\n     */\n    async executeRequest(content) {\n        const result = await this._sendRequestMessageToWorker('execute-request', content);\n        return {\n            execution_count: this.executionCount,\n            ...result\n        };\n    }\n    /**\n     * Handle an complete_request message\n     *\n     * @param msg The parent message.\n     */\n    async completeRequest(content) {\n        return await this._sendRequestMessageToWorker('complete-request', content);\n    }\n    /**\n     * Handle an `inspect_request` message.\n     *\n     * @param content - The content of the request.\n     *\n     * @returns A promise that resolves with the response message.\n     */\n    async inspectRequest(content) {\n        return await this._sendRequestMessageToWorker('inspect-request', content);\n    }\n    /**\n     * Handle an `is_complete_request` message.\n     *\n     * @param content - The content of the request.\n     *\n     * @returns A promise that resolves with the response message.\n     */\n    async isCompleteRequest(content) {\n        return await this._sendRequestMessageToWorker('is-complete-request', content);\n    }\n    /**\n     * Handle a `comm_info_request` message.\n     *\n     * @param content - The content of the request.\n     *\n     * @returns A promise that resolves with the response message.\n     */\n    async commInfoRequest(content) {\n        return await this._sendRequestMessageToWorker('comm-info-request', content);\n    }\n    /**\n     * Send an `input_reply` message.\n     *\n     * @param content - The content of the reply.\n     */\n    inputReply(content) {\n        this._worker.postMessage({\n            type: 'input-reply',\n            data: content,\n            parent: this.parent\n        });\n    }\n    /**\n     * Send an `comm_open` message.\n     *\n     * @param msg - The comm_open message.\n     */\n    async commOpen(msg) {\n        return await this._sendRequestMessageToWorker('comm-open', msg);\n    }\n    /**\n     * Send an `comm_msg` message.\n     *\n     * @param msg - The comm_msg message.\n     */\n    async commMsg(msg) {\n        return await this._sendRequestMessageToWorker('comm-msg', msg);\n    }\n    /**\n     * Send an `comm_close` message.\n     *\n     * @param close - The comm_close message.\n     */\n    async commClose(msg) {\n        return await this._sendRequestMessageToWorker('comm-close', msg);\n    }\n    /**\n     * Send a message to the web worker\n     *\n     * @param type The message type to send to the worker.\n     * @param data The message to send to the worker.\n     */\n    async _sendRequestMessageToWorker(type, data) {\n        this._executeDelegate = new PromiseDelegate();\n        this._worker.postMessage({ type, data, parent: this.parent });\n        return await this._executeDelegate.promise;\n    }\n}\n","// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\nimport { IKernelSpecs } from '@jupyterlite/kernel';\nimport { XeusKernel } from '@jupyterlite/xeus-kernel';\n/**\n * A plugin to register the Xeus kernel.\n */\nconst kernel = {\n    id: '@jupyterlite/xeus-kernel-extension:kernel',\n    autoStart: true,\n    requires: [IKernelSpecs],\n    activate: (app, kernelspecs) => {\n        kernelspecs.register({\n            spec: {\n                name: 'Xeus-Lua',\n                display_name: 'Xeus-Lua',\n                language: 'lua',\n                argv: [],\n                spec: {\n                    argv: [],\n                    env: {},\n                    display_name: 'Xeus-Lua',\n                    language: 'lua',\n                    interrupt_mode: 'message',\n                    metadata: {}\n                },\n                resources: {\n                    'logo-32x32': 'TODO',\n                    'logo-64x64': '/kernelspecs/xeus_small.svg'\n                }\n            },\n            create: async (options) => {\n                return new XeusKernel({\n                    ...options\n                });\n            }\n        });\n    }\n};\nconst plugins = [kernel];\nexport default plugins;\n"],"sourceRoot":""}